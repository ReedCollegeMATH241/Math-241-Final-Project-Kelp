---
title: "Spatial and Temporal Trends of Fine Particulate Matter in Western Oregon"
author: "Makoto Kelp"
date: "May 11, 2015"
output:
  html_document:
    keep_md: yes
---

The purpose of this project is to explore the spatial and temporal distributions of particulate matter. Aerosols are the total amount of suspended solid and liquid particles in the air. This mixture of particles contains inorganic and organic components (organic meaning carbon-composed and inorganic meaning non-carbon-composed molecules), both from natural and anthropogenic sources. PM 2.5 or fine PM (a class of aerosols) will be the focus of this analysis. The 2.5 refers to the diameter of the particle in micrometers. PM 2.5 is indiscernible to the human eye (thus the "fine" designation). Fine PM may form from inefficient combustion due to motor vehicles, residential wood burning, and other local industrial processes. Fossil fuel combustion is the burning of hydrocarbon fuel in addition to oxygen, which yields carbon dioxide, water, and heat as energy:

$$H_{x}C_{x} + O_{2}  \rightarrow H_{2}O + CO_{2} + heat + Particulate Matter$$

However, not all engines combust their fuels cleanly and completely and therefore additional PM combustion products including soot and exhaust, which may comprise volatile organics, are produced.

One may ask why may we care about PM2.5? Perhaps most immediately because fine PM is an environmental health hazard. It has the potential to cause a slew of different health effects from asthma exacerbation to higher rates of mortality in men, women, and children. The pollutant also has certain atmospheric climate effects such as global warming and regional cooling.   

The raw PM data (CSV) was supplied by Anthony Barnack from the Oregon Department of Environmental Quality (DEQ). The data comes from nine different monitoring sites from around Western Oregon from locations such as Sauvie Island to Salem. All data have been collected by particulate matter monitoring instruments such as a DustTrak and AeroTrak. The data ranges over a two year period from January 2013 to December 2014. PM and other air quality pollutant data may be obtained from the DEQ upon request.  

The following report contains a temporal and spatial analysis of fine PM data from Western Oregon. 


```{r, echo=FALSE, warning=FALSE, message=FALSE}

suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(magrittr))
suppressPackageStartupMessages(library(devtools))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(ggmap))


DEQ <- read.csv("./pm2.5 for reed corrected.csv", header=TRUE, stringsAsFactors = FALSE) %>% select(-X) %>% tbl_df()

DEQ<- DEQ[-1,] 
DEQ<- DEQ[-1,]

colnames(DEQ)[1] <- "Temp_Time"
colnames(DEQ)[2] <- "Albany_Calapooia_School"
colnames(DEQ)[3] <- "Beaverton_Highland_Park"
colnames(DEQ)[4] <- "Carus_Spangler_Rd"
colnames(DEQ)[5] <- "Corvallis_Circle_Blvd"
colnames(DEQ)[6] <- "Hillsboro_Hare_Field"
colnames(DEQ)[7] <- "Portland_SE_Lafayette"
colnames(DEQ)[8] <- "Salem_State_Hospital"
colnames(DEQ)[9] <- "Sauvie_Island"
colnames(DEQ)[10] <- "Sweet_Home_Fire_Department"


temp.dates <- mdy_hm(DEQ$Temp_Time, format= "%m %d %Y %H%M%p" )
temp.dates <- temp.dates[-length(temp.dates)]
DEQ$Pacific_Daylight_Time <- temp.dates

DEQ$Pacific_Daylight_Time<- floor_date(DEQ$Pacific_Daylight_Time, "day")

yearmeanexample<- group_by(DEQ, Pacific_Daylight_Time) %>% summarise(PDX=mean(as.numeric(Portland_SE_Lafayette)))
```


##Exploratory Data Visualization Analysis

Perhaps some exploratory data visualization is needed. Below is a plot of the two year monitored time period for the SE Lafayette Portland site. From a quick glance we can see that there is a cyclic pattern to the data. PM seems to peak in the winter months and has a trough in the summer months. This shape is due to the fact that there is more combustion activity in the winter (think home heating) than in the summer. If we assume that PM's sink is deposition and assume the same rate of deposition for all seasons, then it makes sense that the season with the highest rate of production (winter) will have higher overall concentrations. Perhaps for the more scientific inclined readers the following explanation from the EPA might warrant additional thought:

"Fine particles also have seasonal patterns... Fine particle concentrations tend to be higher in the fourth calendar quarter (October-December) in many areas of the West, in part because fine particle nitrates are more readily formed in cooler weather, and wood stove and fireplace use produces more carbon." (Source: http://cfpub.epa.gov/eroe/index.cfm?fuseaction=detail.viewPDF&ch=46&lShowInd=0&subtop=341&lv=list.listByChapter&r=231331)

One must also note that PM is highly susceptible to specific source events that can drive the average up for a period of time (such as a fire or congregation of old diesel trucks).  



```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=6}
ggplot(yearmeanexample, aes(x=Pacific_Daylight_Time, y=PDX)) + geom_line(color = "firebrick")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("2013-14 SE Lafayette Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))
# note cyclic pattern 
```



```{r, echo=FALSE, warning=FALSE, message=FALSE}

#Seasons
winter13 <- interval(ymd(20130101), ymd(20130228))
spring13 <- interval(ymd(20130301), ymd(20130531))
summer13 <- interval(ymd(20130601), ymd(20130831))
fall13 <- interval(ymd(20130901), ymd(20131130))
winter14 <- interval(ymd(20131201), ymd(20140228))
spring14 <- interval(ymd(20140301), ymd(20140531))
summer14 <- interval(ymd(20140601), ymd(20140831))
fall14 <- interval(ymd(20140901), ymd(20141130))


winter13data <- filter(DEQ, Pacific_Daylight_Time %within% winter13)
spring13data <- filter(DEQ, Pacific_Daylight_Time %within% spring13)
summer13data <- filter(DEQ, Pacific_Daylight_Time %within% summer13)
fall13data <- filter(DEQ, Pacific_Daylight_Time %within% fall13)
winter14data <- filter(DEQ, Pacific_Daylight_Time %within% winter14)
spring14data <- filter(DEQ, Pacific_Daylight_Time %within% spring14)
summer14data <- filter(DEQ, Pacific_Daylight_Time %within% summer14)  
fall14data <- filter(DEQ, Pacific_Daylight_Time %within% fall14)  
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Winter 13

winter13means<- group_by(winter13data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)),Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette)),Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)),SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))

w13a<- ggplot (winter13means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13b<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

#no Carus Data

w13d<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13e<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13f<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13g<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13h<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w13i<- ggplot(winter13means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2013 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

##Multiplot Code needed

multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)
  
  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)
  
  numPlots = length(plots)
  
  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                     ncol = cols, nrow = ceiling(numPlots/cols))
  }
  
  if (numPlots==1) {
    print(plots[[1]])
    
  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
    
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
      
      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
```

##Seasonal Variations in Fine PM

Note below the comparison of eight monitoring sites in Western Oregon during winter 2013 (there was no data for the Carus site during this time period). For the sake of this analysis the seasons are defined: winter is from Dec to Feb (Dec is excluded for winter 2013 due to no data); spring is from Mar to May; summer is from June to Aug; and fall is from Sep to Nov. This hopefully is the most accurate method to represent the seasons, it allows us to use most all of the data over two years provided to us. Also note that gaps have purposefully been included in these graphs to make aware of the missing data at these sites. 


##Winter 2013

Note that winter 2013 has a PM range from 0 to around 40 micrograms/m3. One may also notice that although the sites are spatially spread, the PM peaks seem to line up at all the sites. Notice that there is a unified local maxima peak on around Jan 12. One may propose that this may be due to elevated levels of combustion in the area during this period or perhaps even more creative interpretations such as Sunday "Church traffic" coupled with the local public schools starting back up again creating more activity in the area. To be sure, there is no one right answer as to why there is a peak event in the region during this time.  


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=12}
multiplot(w13a, w13b, w13d, w13e, w13f, w13g, w13h, w13i, cols=3)
```



```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Spring 2013

spring13means<- group_by(spring13data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))


s13a<- ggplot (spring13means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13b<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

#no Carus Data

s13d<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13e<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13f<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13g<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13h<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

s13i<- ggplot(spring13means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2013 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))
```

##Spring 2013

Continuing our analysis for the spring 2013 season, the reader may realize a noticeable change. The magnitude of PM 2.5 has dramatically been reduced from a range of 0-~40 to that of 0-~25. This change is most likely due to the reduction of combustion in the region due to people using less heating for their homes. 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=12}
multiplot(s13a, s13b, s13d, s13e, s13f, s13g, s13h, s13i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Summer 13

summer13means<- group_by(summer13data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))


su13a<- ggplot (summer13means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13b<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13c<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Carus)) + geom_line(color = "green") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Carus Spangler Road") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13d<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13e<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13f<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13g<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13h<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su13i<- ggplot(summer13means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2013 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))
```


##Summer 2013

Perhaps the most interesting comparison would be that between summer and winter. Viewing the below plot, we can see a change in axes in order to view the data in a more appropriate and meaningful fashion. The range of PM concentration is even smaller than spring, with a range from 0 to ~10 micrograms/m3. This drastic reduction is due to presumably little to no combustion due to heating homes and the elevated temperature which reduces the formation of fine particulate nitrate and other specific PM components that contribute to the overall monitored concentration. 


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=12}

multiplot(su13a, su13b, su13c, su13d, su13e, su13f, su13g, su13h, su13i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Fall 13

fall13means<- group_by(fall13data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))


f13a<- ggplot (fall13means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13b<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13c<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Carus)) + geom_line(color = "green") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Carus Spangler Road") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13d<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13e<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13f<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13g<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13h<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f13i<- ggplot(fall13means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2013 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))
```

##Fall 2013

Finally, for the sake of thoroughness, fall 2013 PM concentrations are below. The range of the PM data is from 0 to 40 micrograms/m3 which is the same as that for winter, but notice that most of that range is attributed to the increasing peak found at the end of the season. Also note that this increasing peak is found in all the graphs (except Carus which has no data during that time). We may strongly suggest that PM is highly correlated from site to site, as they track specific trends very well. 


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=12}
multiplot(f13a, f13b, f13c, f13d, f13e, f13f, f13g, f13h, f13i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Winter 14

winter14means<- group_by(winter14data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))



w14a<- ggplot (winter14means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14b<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

#No Carus Data

w14d<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14e<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14f<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14g<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14h<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

w14i<- ggplot(winter14means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Winter 2014 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))


#multiplot(w14a, w14b, w14d, w14e, w14f, w14g, w14h, w14i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

##Spring 14

spring14means<- group_by(spring14data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))


s14a<- ggplot (spring14means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14b<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

#no Carus Data

s14d<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14e<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14f<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14g<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14h<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

s14i<- ggplot(spring14means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Spring 2014 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 20))

#multiplot(s14a, s14b, s14d, s14e, s14f, s14g, s14h, s14i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
##Summer 14
summer14means<- group_by(summer14data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)), Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))


su14a<- ggplot (summer14means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14b<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Beaverton Highland Park") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14c<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Carus)) + geom_line(color = "green") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Carus Spangler Road") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14d<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14e<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14f<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14g<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14h<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))

su14i<- ggplot(summer14means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Summer 2014 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 12))


#multiplot(su14a, su14b, su14c, su14d, su14e, su14f, su14g, su14h, su14i, cols=3)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
##FAll 14

fall14means<- group_by(fall14data, Pacific_Daylight_Time) %>% summarise(Albany=mean(as.numeric(Albany_Calapooia_School)), Beaverton=mean(as.numeric(Beaverton_Highland_Park)), Carus=mean(as.numeric(Carus_Spangler_Rd)),  Corvallis=mean(as.numeric(Corvallis_Circle_Blvd)), Hillsboro=mean(as.numeric(Hillsboro_Hare_Field)), Lafayette=mean(as.numeric(Portland_SE_Lafayette  )), Salem=mean(as.numeric(Salem_State_Hospital)), Sauvie=mean(as.numeric(Sauvie_Island)), SweetHome=mean(as.numeric(Sweet_Home_Fire_Department)))

f14a<- ggplot (fall14means, aes(x=Pacific_Daylight_Time, y=Albany)) + geom_line(color = "red") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Albany Calapooia School") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14b<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Beaverton)) + geom_line(color = "blue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Beaverton Highland Park") + 
  theme_classic() 

f14c<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Carus)) + geom_line(color = "green") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Carus Spangler Road") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14d<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Corvallis)) + geom_line(color = "black") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Corvallis Circle Blvd.") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14e<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Hillsboro)) + geom_line(color = "pink")+ 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Hillsboro Hare Field") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14f<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Lafayette)) + geom_line(color = "orange") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 SE Lafayette, Portland") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14g<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Salem)) + geom_line(color = "purple") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Salem State Hospital") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14h<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=Sauvie)) + geom_line(color = "dodgerblue") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Sauvie Island") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))

f14i<- ggplot(fall14means, aes(x=Pacific_Daylight_Time, y=SweetHome)) + geom_line(color = "firebrick") + 
  xlab("Pacific Daylight Time") + ylab("PM2.5 (ug/m3)") + ggtitle ("Fall 2014 Sweet Home Fire Department") + 
  theme_classic() + scale_y_continuous(limits = c(0, 45))



#multiplot(f14a, f14b, f14c, f14d, f14e, f14f, f14g, f14h, f14i, cols=3) #Beaverton large peak event
```



```{r, echo=FALSE, warning=FALSE, message=FALSE}


##Missing Data

#winter13data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))})

#spring13data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#summer13data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#fall13data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#winter14data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#spring14data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#summer14data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

#fall14data[,c(2:10)] %>% apply(2, as.numeric) %>% apply(2, function(x){mean(is.na(x))}) 

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
#Averages

winter13seasonmean<- summarise(winter13means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

spring13seasonmean<- summarise(spring13means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

summer13seasonmean<- summarise(summer13means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

fall13seasonmean<- summarise(fall13means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

winter14seasonmean<- summarise(winter14means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

spring14seasonmean<- summarise(spring14means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

summer14seasonmean<- summarise(summer14means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))

fall14seasonmean<- summarise(fall14means, na.rm = TRUE, Albany=mean(as.numeric(Albany), na.rm = TRUE),
                               Beaverton=mean(as.numeric(Beaverton), na.rm = TRUE),
                               Carus=mean(as.numeric(Carus), na.rm = TRUE),
                               Corvallis=mean(as.numeric(Corvallis), na.rm = TRUE),
                               Hillsboro=mean(as.numeric(Hillsboro), na.rm = TRUE),
                               Lafayette=mean(as.numeric(Lafayette), na.rm = TRUE),
                               Salem=mean(as.numeric(Salem), na.rm = TRUE),
                               Sauvie=mean(as.numeric(Sauvie), na.rm = TRUE),
                               SweetHome=mean(as.numeric(SweetHome),na.rm = TRUE))
```


## Summary Statistics for Seasonal Averages

From viewing the tables below we can see that on average the SE Lafayette site in Portland produces the highest concentration of PM for the year. This is most likely due to the fact that this site is the most urban of all the monitoring sites and thus has the highest amount of combustion activity and therefore pollution. Because this site seems to be the most interesting to us at Reed College for multiple reasons, such as proximity and acts as a "ceiling" for the other sites, we will use the Lafayette site to compare variation over years.  

```{r, echo=FALSE}

winter13title<- paste("Winter 2013 Monthly Averages")
kable(winter13seasonmean, caption = winter13title, col.names= colnames(winter13seasonmean))

spring13title<- paste("Spring 2013 Monthly Averages")
kable(spring13seasonmean, caption = spring13title, col.names= colnames(spring13seasonmean))

summer13title<- paste("Summer 2013 Monthly Averages")
kable(summer13seasonmean, caption = summer13title, col.names= colnames(summer13seasonmean))

fall13title<- paste("Fall 2013 Monthly Averages")
kable(fall13seasonmean, caption = fall13title, col.names= colnames(fall13seasonmean))

```


##Temporal Variations for SE Lafayette, Portland

Unfortunately from the seasonal plots below for the Lafayette site we cannot conclude much about specific in-season patterns about fine PM. We can see a general consistency for the magnitude of our pollutant, but not much about a cyclic in-season pattern. The local minima and maxima of peaks seem to be random except for the increasing peak found at the end of fall for both 2013 and 2014, which is due more to a general annual-seasonal pattern and not that of a within season pattern. Perhaps one may suggest that PM is highly dependent on individual events and are essentially regionally determined and that there is not a predetermined in-season pattern that is apparent.  


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=12}
multiplot(w13f, s13f, su13f, f13f, w14f, s14f, su14f, f13f, cols=2)
```

##Particulate Matter Maps of Western Oregon

The following are maps of the PM monitoring sites in Western Oregon. The circles are located at the areas of the sites and the size of the circles relates to the measured concentration of particulate matter for that site during the specified season.  

```{r, echo=FALSE, warning=FALSE, message=FALSE}

#geocode('Albany Calapooia School')
#geocode('Beaverton Highland Park, OR')
#geocode('Carus Spangler Road') 
#geocode('Corvallis Circle Blvd')
#geocode('Hillsboro Hare Field')
#geocode('SE Lafayette, Portland, OR')
#geocode('Salem State Hospital, OR')
#geocode('Sauvie Island, OR')
#geocode('Sweet Home Fire Department, OR')


##Oregon Map Summer 13
mapdatasummer <- 
  data.frame(
    location = c('Albany Calapooia School', 'Beaverton Highland Park', 'Carus Spangler Road', 
                 'Corvallis Circle Blvd', 'Hillsboro Hare Field','SE Lafayette, Portland', 
                 'Salem State Hospital', 'Sauvie Island', 'Sweet Home Fire Department'
                 ),
    lat = c(44.6156, 45.4702, 45.2593, 44.5884, 45.5285, 45.4966, 44.9431, 45.7685, 44.3958),
    lon = c(-123.0916, -122.8162, -122.588, -123.2673, -122.9724, -122.6029, -123.0059, -122.7721,
            -122.7299),
    con = c(4.054258, 3.543086, 4.79918, 3.166856, 3.329494, 4.928186, 4.009524, 4.414915, 3.149634)
  )



OR <- get_map("Salem, Oregon", zoom=8)

p <- ggmap(OR)

mapsu<- p + geom_point(data=mapdatasummer, aes(x=lon, y=lat), color="black", size=mapdatasummer$con, alpha=0.5)
```

##Summer 2013
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=6}


p + geom_point(data=mapdatasummer, aes(x=lon, y=lat), color="black", size=mapdatasummer$con, alpha=0.5)
```


```{r, echo=FALSE, warning=FALSE, message=FALSE}
##Oregon Map Winter 13
mapdatawinter <- 
  data.frame(
    location = c('Albany Calapooia School', 'Beaverton Highland Park', 'Carus Spangler Road', 
                 'Corvallis Circle Blvd', 'Hillsboro Hare Field','SE Lafayette, Portland', 
                 'Salem State Hospital', 'Sauvie Island', 'Sweet Home Fire Department'
    ),
    lat = c(44.6156, 45.4702, 45.2593, 44.5884, 45.5285, 45.4966, 44.9431, 45.7685, 44.3958),
    lon = c(-123.0916, -122.8162, -122.588, -123.2673, -122.9724, -122.6029, -123.0059, -122.7721,
            -122.7299),
    con = c(9.069303, 10.59581,  NaN,  8.605113,	12.98534,	12.7897,	10.28486,	7.873078,	8.79136)
  )
  
  mapw<- p + geom_point(data=mapdatawinter, aes(x=lon, y=lat), color="black", size=mapdatawinter$con, alpha=0.5) 
```
  
##Winter 2013
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=6}
p + geom_point(data=mapdatawinter, aes(x=lon, y=lat), color="black", size=mapdatawinter$con, alpha=0.5)
```


##2013 Summer, Winter Comparison
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=8}
multiplot(mapw, mapsu, cols = 2)
```

At this point, perhaps it is obvious to the reader that there is a seasonal difference for PM concentration. However, the above map is a nice visual to understand that PM is a product of incomplete combustion and that that process is most likely to happen in urban areas, i.e., Portland. Notice that the size of the concentric circles are much larger in the Portland metro area than it is for that of Salem and Corvallis. This difference is due to the elevated industrial and commercial activity found in urban centers.  


##Portland Specific Visual

Because Reed College is situated on the banks of the Willamette River and near downtown Portland, it seems appropriate to create a visual that deals with the particulate matter monitoring sites found in the Portland metro area. Because our last comparison was using 2013 data, let us employ 2014 data for a change. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
##PDX Map Summer 14

PDXmapdatasummer <- 
  data.frame(
    location = c('Beaverton Highland Park', 'Carus Spangler Road', 
                 'Hillsboro Hare Field','SE Lafayette, Portland', 
                  'Sauvie Island'
    ),
    lat = c(45.4702, 45.2593, 45.5285, 45.4966, 45.7685),
    lon = c(-122.8162, -122.588, -122.9724, -122.6029, -122.7721),
    con = c(3.835046, 3.756921, 3.682647, 5.227395, 4.853287)
  )

PDX <- get_map("Portland, Oregon", zoom=10, maptype = "roadmap", color= "color")

pland <- ggmap(PDX)

pdxmapsu14<- pland + geom_point(data=PDXmapdatasummer, aes(x=lon, y=lat), color="black", size=PDXmapdatasummer$con, alpha=0.7)
```



##PDX Map Summer 2014
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=6}
pland + geom_point(data=PDXmapdatasummer, aes(x=lon, y=lat), color="black", size=PDXmapdatasummer$con, alpha=0.7)
```


```{r, echo=FALSE, warning=FALSE, message=FALSE}
PDXmapdatawinter <- 
  data.frame(
    location = c('Beaverton Highland Park', 'Carus Spangler Road', 
                 'Hillsboro Hare Field','SE Lafayette, Portland', 
                 'Sauvie Island'
    ),
    lat = c(45.4702, 45.2593, 45.5285, 45.4966, 45.7685),
    lon = c(-122.8162, -122.588, -122.9724, -122.6029, -122.7721),
    con = c(10.06423, NaN, 13.37603, 10.98643, 7.373769)
  )


pdxmapw14<- pland + geom_point(data=PDXmapdatawinter, aes(x=lon, y=lat), color="black", size=PDXmapdatawinter$con, alpha=0.7)
```


##PDX Map Winter 2014
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=6, fig.height=6}
pland + geom_point(data=PDXmapdatawinter, aes(x=lon, y=lat), color="black", size=PDXmapdatawinter$con, alpha=0.7)
```

##PDX Summer, Winter 2014
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=8, fig.height=8}
multiplot(pdxmapw14, pdxmapsu14, cols = 2)
```


##Conclusions

From our exploratory analysis, we can interpret some trends for PM 2.5. We understand that PM is highly variable depending on the region. It seems as though the trend for Oregon and presumably the Pacific Northwest is a peak in the winter and a trough in the summer due to combustion activity and favorable temperatures for fine particle nitrates (a specific component of particulate matter). From our data, we were not able to necessarily conclude a specific within-season pattern for the monitoring sites, although the persistent increasing peak at the end of fall may be considered an in-season pattern, but is more likely the result of the  general annual-seasonal pattern changing from fall to winter. We can also conclude that urban areas produce more PM because of a greater presence of combustion via industrial and residential activity. 

Perhaps a component that cannot necessarily be touched upon with simple summary statistics is the role of peak events. We have used seasonally averaged data to use for our concentrations on our maps. However, these average concentrations do not account for specific point sources that can be hazardous to health. 

For example, referencing the winter 2013 fine PM data for the SE Lafayette site, we notice that there was a monthly average of 12.7897 micrograms/m3. However, if we view the time series plot we notice a large peak event on Jan 12 that has a value of 42.000 micrograms/m3. If we employ North Carolina's Department of Environment and Natural Resources guideline for PM2.5 air quality (http://daq.state.nc.us/airaware/forecast/pm_codecalc.shtml)
, a 12.7897 microgram concentration yields a "green" level of health concern while a 42.000 microgram concentration yields an "orange" level of health concern. These colors are according to the EPA's Air Quality Index (AQI) guide (http://www.airnow.gov/index.cfm?action=aqi_brochure.index), where green is "good" and "orange" is "unhealthy for sensitive groups". With this understanding that health concerns are driven by specific source events, one may realize that monthly averages may be deceptive. Although averages are important in terms of EPA and government monitoring of overall air quality, one must understand that specific events close to individuals are the true concern of health hazards. 

These results apply to the Reed College community and the population of the Portland metro area. This analysis was simply a general overview regarding the sources, monitoring, and interpretation of fine particulate matter data. A plausible extension to this analysis would potentially include an ARIMA (Autoregressive Integrated Moving Average) calculation that may help determine the "staying power" of a pollutant, that is, its potential atmospheric lifetime.  


